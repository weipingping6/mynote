<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>cnvas插入图片及操作</title>
<style>
#wrap{background:#666;width:300px;height:260px;margin:20px auto;text-align:center;padding:20px 0;}
</style>
<script>
window.onload=function(){
 var ab=document.getElementsByTagName('input');
 var oimg=document.getElementById('img1');
 var num=0;
 var yuimg=new Image();
 yuimg.onload=function(){draw(oimg)}
 yuimg.src=oimg.src;
 
 function draw(obj){
  var oc=document.createElement('canvas');
  var ocg=oc.getContext('2d');
  oc.width=obj.width;
  oc.height=obj.height;
  obj.parentNode.replaceChild(oc,obj)
  ocg.drawImage(obj,0,0)
 
 ab[1].onclick=function(){
  if(num==3){num=0}
  else{num++}
  tochange() 	}
 ab[0].onclick=function(){
  if(num==0){num=3}
  else{num--}
  tochange() }
 
 function tochange(){
  switch(num){
	case 1:oc.width=obj.height;
		   oc.height=obj.width;
		   ocg.rotate((1/2)*Math.PI)	
		   ocg.drawImage(obj,0,-obj.height)
		break;  
	case 2:oc.width=obj.width;
		   oc.height=obj.height;
		   ocg.rotate(Math.PI)	
		   ocg.drawImage(obj,-obj.width,-obj.height)
		break;
    case 3:oc.width=obj.height;
		   oc.height=obj.width;
		   ocg.rotate((-1/2)*Math.PI)	
		   ocg.drawImage(obj,-obj.height,0)
		 break;
	case 0:oc.width=obj.width;
		   oc.height=obj.height;	
		   ocg.drawImage(obj,0,0) ;
		 break;     
  }	 	
 }}
}
</script>
</head>

<body>
  <div id='wrap'>
    <input type='button' value='逆时针'/>
    <input type='button' value='顺时针'/><br /><br />
    <div>
    <img src='img/idol1.jpg' id='img1'/>
    </div>
  </div>  
</body>
</html>
